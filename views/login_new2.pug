html
    head
        meta(charset='utf-8')
        meta(name='result', content=900)
        meta(http-equiv='X-UA-Compatible', content='IE=edge')
        meta(name='viewport', content='width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover')
        meta(name='description', content='Sequenzia Login Page')
        meta(name='author', content='Yukimi Kazari')
        meta(content=site_name || "Sequenzia" property="og:title")
        meta(content="Image Gallery and File Manager" property="og:description")
        meta(content=site_name || "Sequenzia" property="og:site_name")
        title=`Lets Login`
        meta(name="apple-mobile-web-app-capable" content="yes")
        meta(name="apple-mobile-web-app-title" content=site_name || "Sequenzia")
        meta(name="apple-mobile-web-app-status-bar-style" content="black-translucent")
        link(rel='apple-touch-icon' sizes='180x180' href='/static/img/icons/android/android-launchericon-192-192.png')
        link(rel='icon' type='image/png' sizes='32x32' href='/static/img/icons/firefox/firefox-general-32-32.png')
        link(rel='icon' type='image/png' sizes='16x16' href='/static/img/icons/chrome/firefox-general-16-16.png')
        link(href='/static/img/splash/apple/iphone5_splash.png' media='screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphone5_splash_landscape.png' media='screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphone6_splash.png' media='screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphone6_splash_landscape.png' media='screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphoneplus_splash.png' media='screen and (device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphoneplus_splash_landscape.png' media='screen and (device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphonex_splash.png' media='screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphonex_splash_landscape.png' media='screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphonexr_splash.png' media='screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphonexr_splash_landscape.png' media='screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphonexsmax_splash.png' media='screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphonexsmax_splash_landscape.png' media='screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphone11pro_splash.png' media='screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphone11pro_splash_landscape.png' media='screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphone11promax_splash.png' media='screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/iphone11promax_splash_landscape.png' media='screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipad_splash.png' media='screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipad_splash_landscape.png' media='screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipadpro1_splash.png' media='screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipadpro1_splash_landscape.png' media='screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipadpro3_splash.png' media='screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipadpro3_splash_landscape.png' media='screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipadpro2_splash.png' media='screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)' rel='apple-touch-startup-image')
        link(href='/static/img/splash/apple/ipadpro2_splash_landscape.png' media='screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)' rel='apple-touch-startup-image')

        link(rel='manifest' href='/static/manifest.json')

        link(rel='stylesheet', href="/static/vendor/fontawesome/css/fontawesome.min.css")
        link(rel='stylesheet', href="/static/vendor/fontawesome/css/all.min.css")
        link(rel="stylesheet", href="/css/login_new.min.css")

        script(src="/static/vendor/jquery/jquery.min.js")
    body
        - loginImage = ((webconf.login_image_overides) ? (typeof webconf.login_image_overides === "string" ) ? webconf.login_image_overides : webconf.login_image_overides[Math.floor(Math.random() * webconf.login_image_overides.length)] : "/static/img/loading_bg.jpeg").replace('https://cdn.discordapp.com/attachments/', 'https://media.discordapp.net/attachments/')
        style.
            body {
                background: url("!{loginImage}") center fixed
            }
        if (banner)
            div(style="display: block; position: fixed; left: 0; width: 100vw; z-index: 100000;")
                div(style="color: white;background: #930000;font-size: 1.35em;text-align: center;")
                    span !{banner}
        #container
            #inviteContainer
                div.inner-container
                    .acceptContainer
                        .logo-container
                            img.top-logo(src=`${(webconf.login_banner_overides) ? webconf.login_banner_overides : "/static/img/sequenzia-logo-nav.png"}`)
                        if (noLoginAvalible)
                            div.failure
                                if (noLoginAvalible === 'nomember')
                                    div.failure-header
                                        i.fas.fa-passport.fa-3x
                                        h3 No Passport
                                    div.failure-message
                                        p Your account has no access rights
                                else if (noLoginAvalible === 'esm_activated')
                                    div.failure-header
                                        i.fas.fa-lock.fa-3x
                                        h3 Security Failure
                                    div.failure-message
                                        p A Security issues has occurred during the authentication phase, please contact a system administrator
                                        p Error Code: ESM-#{serverError || '0000'}
                                else if (noLoginAvalible === 'noauth')
                                    div.failure-header
                                        i.fas.fa-user-xmark.fa-3x
                                        h3 No Permissiona
                                else
                                    div.failure-header
                                        i.fas.fa-ban.fa-3x
                                        h3 No Valid Membership
                        else if (authenticatedDevice)
                            div.success
                                div.failure-header
                                    i.fas.fa-check-circle.fa-3x
                                    h3 Login Complete!
                        else if (authfailedDevice)
                            div.failure
                                div.failure-header
                                    i.fas.fa-times-circle.fa-3x
                                    h3 Login Failed
                        else if (serverError)
                            div.failure
                                div.failure-header
                                    i.fas.fa-times-circle.fa-3x
                                    h3 Internal Server Failure
                                div.failure-message
                                    p Error Code: #{serverError || 'Unknown'}
                        else
                            if (login_code)
                                div.login-code
                                    if (show_user_list)
                                        a(href='/discord/users')
                                            span.text-capitalize #{login_code}
                                    else
                                        a(href='#_' onclick="$('#collapseQRCode').toggle(); return false;")
                                            span.text-capitalize #{login_code}

                            div#collapseQRCode.login-qr.collapse.center(style='display: none')
                                if (login_image)
                                    img(src=login_image style='padding-bottom: 1em;')

                div.login-button
                    if (noLoginAvalible)
                        a.acceptBtn(href='/discord/destroy')
                            i.fa-light.fa-sign-out-alt
                            span Cancel
                        if (joinLink && noLoginAvalible === 'nomember')
                            div.seperator
                            a.acceptBtn(href=joinLink)
                                i.fa-light.fa-signature
                                span Join
                    else if (authenticatedDevice || authfailedDevice || serverError)
                        a.acceptBtn(href='/')
                            i.fa-light.fa-home
                            span Home
                    else
                        a.acceptBtn.discord(href='/discord/login')
                            i.fa-light.fa-arrow-right-to-bracket
                            span Login
                        if (joinLink)
                            div.seperator
                            a.acceptBtn(href=joinLink)
                                i.fa-light.fa-signature
                                span Join
    if (login_image)
        script.
            let retryCount = 0;
            setInterval(function () {
                $.ajax({async: true,
                    url: '/device-login?checklogin=true',
                    type: "GET",
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        if (response === 'true') {
                            location.href = '/discord/refresh'
                        } else {
                            retryCount++;
                        }
                    },
                    error: function (response) {
                    }
                });
            }, 60000);
